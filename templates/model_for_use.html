<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Назначение финализированной модели для использования в калькуляторе</title>
    <link rel="stylesheet" type="text/css" href="/static/styles/general.css" />
    <link rel="stylesheet" type="text/css" href="/static/styles/model_for_use.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous"/>
</head>
<body>
<form action="/logout" method="get">
    <div id="logout-form">
        <input type="submit" id="logout-button" value="Выйти">
        <p>{{ name }}</p>
        <p>{{ surname }}</p>
    </div>
</form>
<div class="d-flex flex-column align-items-center">
    <form action="/index" method="get">
        <input type="submit" value="Вернуться назад">
    </form>

    <p class="text-info-main">Список доступных финализированных моделей:</p>

    <form action="new-model" method="post">
        <select name="model">
                <option>CatboostRegressor</option>
        </select>
        <input type="submit" value="Выбрать">
    </form>

    <p class="text-info-main">Список отобранных финализированных моделей:</p>

    <form action="new-model" method="post">
        <select name="model">
                <option>CatboostRegressor</option>
        </select>
        <input type="submit" value="Подтвердить">
    </form>

    <table id="metricsTable" class="metrics-table">
        <thead>
            <tr>
                <th></th>
                <th>CatboostRegressor</th>
                <th>CatboostRegressor 2</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Метрика 1</td>
                <td>100</td>
                <td>110</td>
            </tr>
            <tr>
                <td>Метрика 2</td>
                <td>200</td>
                <td>200</td>
            </tr>
            <tr>
                <td>Метрика 3</td>
                <td>300</td>
                <td>290</td>
            </tr>
        </tbody>
    </table>
    <input style="margin-top: 10px; margin-bottom: 10px;" id="compareButton" type="submit" value="Сравнить">

    <div class="form-container" id="formContainer">
        <h1>Настройка параметров</h1>
        <form id="settingsForm">
            <label for="param1">Параметр 1</label>
            <input type="text" id="param1" name="param1" required>

            <label for="param2">Параметр 2</label>
            <input type="number" id="param2" name="param2" required>

            <label for="param3">Параметр 3</label>
            <input type="text" id="param3" name="param3" required>

            <input type="submit" value="Сохранить">
        </form>
    </div>

    <div class="form-container" id="confirmationContainer" style="display: none;">
        <h1>Подтверждение обновления</h1>
        <p>Вы уверены, что хотите обновить?</p>
        <label for="confirmParam1">Параметр 1</label>
        <input type="text" id="confirmParam1" class="param-value">

        <label for="confirmParam2">Параметр 2</label>
        <input type="number" id="confirmParam2" class="param-value">

        <label for="confirmParam3">Параметр 3</label>
        <input type="text" id="confirmParam3" class="param-value">

        <input type="submit" id="confirmButton" value="Обновить в калькуляторе">
    </div>

    <input id="checkButton" type="submit" style="display: none;" value="Проверить назначение">

    <h2 id="discrepancyHeader" style="display: none;">Результаты проверки</h2>
    <table id="discrepancyTable" class="discrepancy-table">
        <thead>
            <tr>
                <th>Параметр</th>
                <th>Значение</th>
                <th>Ожидаемое значение</th>
            </tr>
        </thead>
        <tbody>
            <!-- Динамически добавляемые строки -->
        </tbody>
    </table>

    <form action="/index" method="get" style="margin-bottom: 50px;">
        <input type="submit" value="Сохранить и выйти">
    </form>

    <script>
        document.getElementById('compareButton').addEventListener('click', function() {
            var table = document.getElementById('metricsTable');
            var formContainer = document.getElementById('formContainer');
            table.style.display = 'table';
            formContainer.style.display = 'block';
            
            var rows = table.rows;
            
            for (var i = 1; i < rows.length; i++) {
                var cell1 = rows[i].cells[1];
                var cell2 = rows[i].cells[2];
                if (cell1.innerText !== cell2.innerText) {
                    cell1.classList.add('highlight');
                    cell2.classList.add('highlight');
                } else {
                    cell1.classList.remove('highlight');
                    cell2.classList.remove('highlight');
                }
            }
        });

        document.getElementById('settingsForm').addEventListener('submit', function(event) {
            event.preventDefault();
            var param1 = document.getElementById('param1').value;
            var param2 = document.getElementById('param2').value;
            var param3 = document.getElementById('param3').value;

            document.getElementById('confirmParam1').value = param1;
            document.getElementById('confirmParam2').value = param2;
            document.getElementById('confirmParam3').value = param3;

            document.getElementById('formContainer').style.display = 'none';
            document.getElementById('confirmationContainer').style.display = 'block';
        });

        document.getElementById('confirmButton').addEventListener('click', function() {
            alert('Параметры обновлены!');
            document.getElementById('confirmationContainer').style.display = 'none';
            document.getElementById('formContainer').style.display = 'block';
            document.getElementById('checkButton').style.display = 'block';
        });

        document.getElementById('checkButton').addEventListener('click', function() {
            var discrepancyHeader = document.getElementById('discrepancyHeader');
            var discrepancyTable = document.getElementById('discrepancyTable');
            var tbody = discrepancyTable.querySelector('tbody');

            // Пример проверки значений
            var param1 = document.getElementById('param1').value;
            var param2 = document.getElementById('param2').value;
            var param3 = document.getElementById('param3').value;

            // Ожидаемые значения (пример)
            var expectedParam1 = 333;
            var expectedParam2 = 123;
            var expectedParam3 = 2;

            // Очистка предыдущих данных
            tbody.innerHTML = "";

            if (param1 !== expectedParam1) {
                var row = tbody.insertRow();
                row.insertCell(0).innerText = "Параметр 1";
                row.insertCell(1).innerText = param1;
                row.insertCell(2).innerText = expectedParam1;
            }

            if (param2 !== expectedParam2) {
                var row = tbody.insertRow();
                row.insertCell(0).innerText = "Параметр 2";
                row.insertCell(1).innerText = param2;
                row.insertCell(2).innerText = expectedParam2;
            }
            if (param3 !== expectedParam3) {
            var row = tbody.insertRow();
            row.insertCell(0).innerText = "Параметр 3";
            row.insertCell(1).innerText = param3;
            row.insertCell(2).innerText = expectedParam3;
            }

            // Показываем таблицу с несоответствиями
            if (tbody.rows.length > 0) {
                discrepancyHeader.style.display = 'block';
                discrepancyTable.style.display = 'table';
            } else {
                discrepancyHeader.style.display = 'none';
                discrepancyTable.style.display = 'none';
            }
        });
    </script>
</div>
</body>
</html>